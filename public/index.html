<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>yt-dlp-ui</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <div class="app-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <h1><img src="/favicon.svg" alt="yt-dlp-ui" style="width: 32px; height: 32px; vertical-align: middle; margin-right: 8px;">yt-dlp-ui</h1>
      </div>
      <nav class="nav-menu">
        <a href="#home" class="nav-item active" data-page="home">
          <span class="icon">üè†</span>
          <span>Home</span>
        </a>
        <a href="#channels" class="nav-item" data-page="channels">
          <span class="icon">üì∫</span>
          <span>Channels</span>
        </a>
        <a href="#profiles" class="nav-item" data-page="profiles">
          <span class="icon">üéØ</span>
          <span>yt-dlp Profiles</span>
        </a>
        <a href="#config" class="nav-item" data-page="config">
          <span class="icon">‚öôÔ∏è</span>
          <span>Config</span>
        </a>
      </nav>
      
      <!-- Footer Links -->
      <div class="sidebar-footer">
        <a href="https://github.com/alexholliz/yt-dlp-ui" target="_blank" class="footer-link" title="View on GitHub">
          <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
          </svg>
          <span>GitHub</span>
        </a>
        <a href="https://github.com/alexholliz/yt-dlp-ui/wiki" target="_blank" class="footer-link" title="Documentation">
          <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
            <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h11A1.5 1.5 0 0 1 15 2.5v11a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 1 13.5v-11zM2.5 2a.5.5 0 0 0-.5.5v11a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5v-11a.5.5 0 0 0-.5-.5h-11z"/>
            <path d="M4 5.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5z"/>
          </svg>
          <span>Docs</span>
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Home Page -->
      <div class="page active" id="page-home">
        <h2 class="page-title">Dashboard</h2>
        
        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value" id="stat-channels">0</div>
            <div class="stat-label">Channels</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="stat-total-downloads">0</div>
            <div class="stat-label">Total Downloads</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="stat-library-size">0 GB</div>
            <div class="stat-label">Library Size</div>
          </div>
        </div>

        <!-- Download History -->
        <div class="content-box">
          <div class="box-header">
            <h3>Media History</h3>
            <div class="pagination" id="history-pagination">
              <button class="btn-icon" onclick="prevHistoryPage()" id="history-prev">‚Äπ</button>
              <span id="history-page-info">Page 1</span>
              <button class="btn-icon" onclick="nextHistoryPage()" id="history-next">‚Ä∫</button>
            </div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Video Title</th>
                <th>Upload Date</th>
                <th>Status</th>
                <th>Indexed</th>
                <th>Downloaded</th>
                <th>Channel</th>
              </tr>
            </thead>
            <tbody id="history-table-body">
              <tr><td colspan="6" class="empty-state">No downloads yet</td></tr>
            </tbody>
          </table>
        </div>

        <!-- Current Queue -->
        <div class="content-box">
          <div class="box-header">
            <h3>Current Queue</h3>
            <div class="pagination" id="queue-pagination">
              <button class="btn-icon" onclick="prevQueuePage()" id="queue-prev">‚Äπ</button>
              <span id="queue-page-info">Page 1</span>
              <button class="btn-icon" onclick="nextQueuePage()" id="queue-next">‚Ä∫</button>
            </div>
          </div>
          <div id="queue-status"></div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Video Title</th>
                <th>Status</th>
                <th>Progress</th>
                <th>Channel</th>
              </tr>
            </thead>
            <tbody id="queue-table-body">
              <tr><td colspan="4" class="empty-state">No items in queue</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Channels Page -->
      <div class="page" id="page-channels">
        <h2 class="page-title">Channels</h2>
        
        <div class="content-box">
          <div class="box-header">
            <h3>All Channels</h3>
            <button class="btn btn-primary" onclick="showAddChannelModal()">+ Add Channel</button>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Channel Name</th>
                <th>Pending</th>
                <th>Downloaded</th>
                <th>Size</th>
                <th>Last Scraped</th>
                <th>Enabled</th>
              </tr>
            </thead>
            <tbody id="channels-table-body">
              <tr><td colspan="6" class="empty-state">No channels added yet</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Profiles Page -->
      <div class="page" id="page-profiles">
        <h2 class="page-title">yt-dlp Profiles</h2>
        
        <div class="content-box">
          <div class="box-header">
            <h3>Download Profiles</h3>
            <button class="btn btn-primary" onclick="showAddProfileModal()">+ Add Profile</button>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Profile Name</th>
                <th>Output Template</th>
                <th>Format</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="profiles-table-body">
              <tr><td colspan="4" class="empty-state">No profiles created yet</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Config Page -->
      <div class="page" id="page-config">
        <h2 class="page-title">Configuration</h2>
        
        <!-- Scheduler Config -->
        <div class="content-box">
          <h3>Scheduler</h3>
          <div class="form-group">
            <label for="scheduler-interval">Check interval (days)</label>
            <input type="number" id="scheduler-interval" value="7" min="1">
          </div>
          <div class="button-group">
            <button class="btn btn-primary" onclick="startScheduler()">Start Scheduler</button>
            <button class="btn btn-secondary" onclick="stopScheduler()">Stop Scheduler</button>
          </div>
          <div id="scheduler-status" class="status-message"></div>
        </div>

        <!-- Cookie Management -->
        <div class="content-box">
          <h3>
            Cookie Management
            <span class="help-icon" title="1. Export cookies from your browser using an extension like 'Get cookies.txt LOCALLY'&#10;2. Paste the cookies into the text area below&#10;3. Click 'Save Cookies' to save them to the server&#10;4. yt-dlp will use these cookies for downloads&#10;5. Click 'Load from cookies.txt' to view currently saved cookies">?</span>
          </h3>
          <p class="help-text">Upload your YouTube cookies for age-restricted or member-only content</p>
          <div class="form-group">
            <label for="cookies-content">Cookies (Netscape format)</label>
            <textarea id="cookies-content" rows="10" placeholder="# Netscape HTTP Cookie File..."></textarea>
          </div>
          <div class="button-group">
            <button class="btn btn-primary" onclick="saveCookies()">Save Cookies</button>
            <button class="btn btn-secondary" onclick="loadCookies()">Load from cookies.txt</button>
            <button class="btn btn-secondary" onclick="testCookies()">Test Cookies</button>
            <button class="btn btn-secondary" onclick="deleteCookies()">Delete Cookies</button>
          </div>
        </div>

        <!-- YouTube Data API -->
        <div class="content-box">
          <h3>
            YouTube Data API v3 (Optional)
            <span class="help-icon" title="Speeds up channel enumeration. Uses yt-dlp web scraping if not provided.">?</span>
            <a href="https://github.com/kieraneglin/pinchflat/wiki/Generating-a-YouTube-API-key" target="_blank" class="docs-link">üìñ Setup Guide</a>
          </h3>
          <p class="help-text">For faster channel/playlist enumeration. Automatically falls back to yt-dlp if quota exceeded or not provided.</p>
          <div class="form-group">
            <label for="youtube-api-key">API Key</label>
            <input type="text" id="youtube-api-key" placeholder="AIzaSy...">
            <small>Free tier: 10,000 units/day (‚âà100-200 full channel enumerations) ‚Ä¢ Resets at midnight Pacific Time</small>
          </div>
          <div class="button-group">
            <button class="btn btn-primary" onclick="saveYouTubeApiKey()">Save API Key</button>
            <button class="btn btn-secondary" onclick="testYouTubeApiKey()">Test API Key</button>
            <button class="btn btn-secondary" onclick="deleteYouTubeApiKey()">Delete API Key</button>
            <button class="btn btn-secondary" onclick="loadYouTubeApiQuota()">Refresh Quota</button>
          </div>
          <div id="youtube-api-quota-status" style="margin-top: 1rem;"></div>
        </div>

        <!-- Logging Configuration -->
        <div class="content-box">
          <h3>
            Logging Configuration
            <span class="help-icon" title="Configure application logging verbosity and rotation">?</span>
          </h3>
          <p class="help-text">Changes to log level apply immediately. Rotation settings apply after restart.</p>
          <div class="form-group">
            <label for="log-level">Log Level</label>
            <select id="log-level">
              <option value="error">Error (least verbose - errors only)</option>
              <option value="warn">Warn (errors + warnings)</option>
              <option value="info">Info (errors + warnings + info)</option>
              <option value="debug">Debug (very verbose - includes yt-dlp commands)</option>
              <option value="silly">Silly (most verbose - everything)</option>
            </select>
            <small>Higher levels include all lower levels. Debug and above will log the exact yt-dlp command used for downloads.</small>
          </div>
          <div class="form-group">
            <label for="log-max-size">Max Log File Size (KB)</label>
            <input type="number" id="log-max-size" min="1024" step="1024" value="10240">
            <small>Log files will rotate when they reach this size (default: 10240 KB = 10 MB)</small>
          </div>
          <div class="form-group">
            <label for="log-max-files">Max Log Files to Keep</label>
            <input type="number" id="log-max-files" min="1" max="20" value="5">
            <small>Number of rotated log files to keep (default: 5)</small>
          </div>
          <div class="button-group">
            <button class="btn btn-primary" onclick="saveLogConfig()">Save Log Configuration</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Channel Detail Modal -->
  <div id="channel-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-channel-name">Channel Details</h2>
        <button class="close-btn" onclick="closeChannelModal()">&times;</button>
      </div>
      <div class="modal-body" id="channel-modal-body">
        <!-- Loaded dynamically -->
      </div>
    </div>
  </div>

  <!-- Video Detail Modal -->
  <div id="video-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-video-title">Video Details</h2>
        <button class="close-btn" onclick="closeVideoModal()">&times;</button>
      </div>
      <div class="modal-body" id="video-modal-body">
        <!-- Loaded dynamically -->
      </div>
    </div>
  </div>

  <!-- Playlist Detail Modal -->
  <div id="playlist-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-playlist-title">Playlist Videos</h2>
        <button class="close-btn" onclick="closePlaylistModal()">&times;</button>
      </div>
      <div class="modal-body" id="playlist-modal-body">
        <!-- Loaded dynamically -->
      </div>
    </div>
  </div>

  <!-- Add Channel Modal -->
  <div id="add-channel-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Add Content</h2>
        <button class="close-btn" onclick="closeAddChannelModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p class="help-text">Add a channel, playlist, or single video URL</p>
        <form id="add-channel-form">
          <div class="form-group">
            <label for="channel-url">YouTube URL</label>
            <input type="text" id="channel-url" placeholder="Channel, Playlist, or Video URL" required>
            <small>Examples: @channelname, /playlists URL, playlist?list=..., or watch?v=...</small>
          </div>
          <div class="form-group">
            <label for="profile-select">yt-dlp Profile</label>
            <select id="profile-select">
              <option value="">None (uses custom options below)</option>
            </select>
            <small>Select a profile or leave as None to use custom yt-dlp options in the Advanced section below</small>
          </div>
          <div class="form-group">
            <label>
              <div class="toggle-switch">
                <input type="checkbox" id="playlist-mode" checked>
                <span class="toggle-slider"></span>
              </div>
              Enumerate Playlists (for channels)
            </label>
          </div>
          <div class="form-group" id="playlist-options">
            <label>
              <div class="toggle-switch">
                <input type="checkbox" id="auto-add-playlists">
                <span class="toggle-slider"></span>
              </div>
              Auto-enable new playlists
            </label>
          </div>
          <div class="form-group">
            <label>
              <div class="toggle-switch">
                <input type="checkbox" id="flat-mode">
                <span class="toggle-slider"></span>
              </div>
              Flat mode (single folder)
            </label>
          </div>

          <!-- Enhanced yt-dlp Options -->
          <div class="content-box" style="margin: 1rem 0;">
            <h3>Enhanced yt-dlp Options</h3>
            
            <!-- Metadata Options -->
            <div class="form-group">
              <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">Metadata</label>
              <div style="margin-left: 0.5rem;">
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="download-metadata">
                    <span class="toggle-slider"></span>
                  </div>
                  Download Metadata
                </label>
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="embed-metadata" checked>
                    <span class="toggle-slider"></span>
                  </div>
                  Embed Metadata
                </label>
              </div>
              <small style="display: block; margin-top: 0.25rem;">Download writes .info.json file. Embed adds metadata to video file.</small>
            </div>

            <!-- Thumbnail Options -->
            <div class="form-group">
              <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">Thumbnails</label>
              <div style="margin-left: 0.5rem;">
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="download-thumbnail">
                    <span class="toggle-slider"></span>
                  </div>
                  Download Thumbnail
                </label>
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="embed-thumbnail">
                    <span class="toggle-slider"></span>
                  </div>
                  Embed Thumbnail
                </label>
              </div>
              <small style="display: block; margin-top: 0.25rem;">Download writes image file. Embed adds thumbnail to video file.</small>
            </div>

            <!-- Subtitle Options -->
            <div class="form-group">
              <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">Subtitles</label>
              <div style="margin-left: 0.5rem;">
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="download-subtitles">
                    <span class="toggle-slider"></span>
                  </div>
                  Download Subtitles
                </label>
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="embed-subtitles">
                    <span class="toggle-slider"></span>
                  </div>
                  Embed Subtitles
                </label>
              </div>
              <small style="display: block; margin-top: 0.25rem;">Download writes .srt/.vtt files. Embed burns subtitles into video.</small>
            </div>

            <div id="subtitle-settings" style="display: none; margin-left: 1rem; padding-left: 1rem; border-left: 2px solid var(--border);">
              <div class="form-group">
                <label for="subtitle-languages">Subtitle Languages</label>
                <input type="text" id="subtitle-languages" value="en" placeholder="en">
                <small>Comma-separated language codes (e.g., en,de,es,fr)</small>
              </div>
              <div class="form-group">
                <label>
                  <div class="toggle-switch">
                    <input type="checkbox" id="auto-subtitles">
                    <span class="toggle-slider"></span>
                  </div>
                  Auto-generated Subtitles
                </label>
                <small style="display: block; margin-top: 0.25rem;">If enabled, downloads auto-generated subtitles when manual ones aren't available</small>
              </div>
            </div>
          </div>

          <!-- SponsorBlock Options -->
          <div class="content-box" style="margin: 1rem 0;">
            <h3>SponsorBlock Options</h3>
            <div class="form-group">
              <label>
                <div class="toggle-switch">
                  <input type="checkbox" id="sponsorblock-enabled">
                  <span class="toggle-slider"></span>
                </div>
                Enable SponsorBlock
              </label>
              <small>Automatically handle sponsored segments and other video sections</small>
            </div>
            <div id="sponsorblock-settings" style="display: none;">
              <div class="form-group">
                <label for="sponsorblock-mode">Behavior</label>
                <select id="sponsorblock-mode">
                  <option value="mark">Mark segments as chapters</option>
                  <option value="remove">Remove segments</option>
                </select>
                <small>Mark: Add chapter markers. Remove: Cut segments from video (requires ffmpeg)</small>
              </div>
              <div class="form-group">
                <label>Categories to process:</label>
                <div style="margin-left: 0.5rem;">
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="sponsor" checked>
                      <span class="toggle-slider"></span>
                    </div>
                    Sponsor
                  </label>
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="intro">
                      <span class="toggle-slider"></span>
                    </div>
                    Intro
                  </label>
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="outro">
                      <span class="toggle-slider"></span>
                    </div>
                    Outro/Credits
                  </label>
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="selfpromo">
                      <span class="toggle-slider"></span>
                    </div>
                    Self-promotion
                  </label>
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="interaction">
                      <span class="toggle-slider"></span>
                    </div>
                    Interaction (Subscribe/Like)
                  </label>
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="preview">
                      <span class="toggle-slider"></span>
                    </div>
                    Preview/Recap
                  </label>
                  <label>
                    <div class="toggle-switch">
                      <input type="checkbox" class="sponsorblock-category" value="music_offtopic">
                      <span class="toggle-slider"></span>
                    </div>
                    Non-music (in music videos)
                  </label>
                </div>
                <small>Select which types of segments to mark or remove</small>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="yt-dlp-options">Custom yt-dlp options</label>
            <textarea id="yt-dlp-options" placeholder="Example: --dateafter 20081004 --format-sort res:1080" rows="3">-v --dateafter 20081004 -f "bv*[height=1080][ext=mp4]+(258/256/140) / best[height=1080] / b" --windows-filenames</textarea>
            <small>Advanced yt-dlp options. Metadata/thumbnails/subtitles are controlled by toggles above. Used only if no profile is selected.</small>
          </div>
          <div class="form-group">
            <label for="rescrape-days">Re-scrape interval (days)</label>
            <input type="number" id="rescrape-days" value="7" min="1">
          </div>
          <button type="submit" class="btn btn-primary">Add</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Add Profile Modal -->
  <div id="add-profile-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Add yt-dlp Profile</h2>
        <button class="close-btn" onclick="closeAddProfileModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="add-profile-form" onsubmit="handleAddProfile(event); return false;">
          <!-- Presets -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>Presets</h3>
            <div class="form-group">
              <label for="preset-select">Select a preset</label>
              <div class="preset-selector">
                <select id="preset-select">
                  <option value="">-- Choose a preset --</option>
                  <option value="plex-youtube">Plex - YouTube-Agent</option>
                </select>
                <button type="button" class="btn btn-secondary" onclick="applyPreset()">Apply Preset</button>
              </div>
            </div>
          </div>

          <!-- General Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>General Options</h3>
            <div class="form-group">
              <label for="profile-name">Profile Name</label>
              <input type="text" id="profile-name" placeholder="e.g., Plex 1080p" required>
            </div>
            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem;">
                <div class="toggle-switch">
                  <input type="checkbox" id="profile-verbose">
                  <span class="toggle-slider"></span>
                </div>
                Verbose Mode (-v)
              </label>
              <small>Enable verbose output for debugging</small>
            </div>
          </div>

          <!-- Output Path Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Output Path Options
              <span class="help-icon" title="Define how downloaded files are named and organized">?</span>
              <a href="https://github.com/yt-dlp/yt-dlp#output-template" target="_blank" class="docs-link">üìñ Docs</a>
            </h3>
            <div class="form-group">
              <label for="profile-output-template">Output Template</label>
              <textarea id="profile-output-template" rows="2" placeholder="%(uploader)s [%(channel_id)s]/..." required></textarea>
              <small>Use yt-dlp output template syntax. Available fields: %(uploader)s, %(channel_id)s, %(playlist_title)s, %(playlist_id)s, %(playlist_index)s, %(title)s, %(id)s, %(ext)s</small>
            </div>
          </div>

          <!-- Format Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Format Options
              <span class="help-icon" title="Control video/audio quality and format selection">?</span>
              <a href="https://github.com/yt-dlp/yt-dlp#format-selection" target="_blank" class="docs-link">üìñ Docs</a>
            </h3>
            <div class="form-group">
              <label for="profile-format">Format Selection</label>
              <input type="text" id="profile-format" placeholder='bv*[height=1080]+ba / best'>
              <small>yt-dlp format string. Examples: "bv*[height=1080]+ba" (1080p video + best audio), "bestvideo+bestaudio" (best quality), "worst" (smallest size)</small>
            </div>
            <div class="form-group">
              <label for="profile-merge-format">Merge Output Format</label>
              <input type="text" id="profile-merge-format" placeholder="mp4">
              <small>Container format after merging video+audio (mp4, mkv, webm, etc.)</small>
            </div>
          </div>

          <!-- Filename Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Filename Options
              <span class="help-icon" title="Control how filenames are sanitized">?</span>
            </h3>
            <div class="form-group">
              <label for="profile-filename-format">Filename Format</label>
              <select id="profile-filename-format">
                <option value="--no-restrict-filenames">No Restrict Filenames (default)</option>
                <option value="--restrict-filenames">Restrict Filenames</option>
                <option value="--windows-filenames">Windows Filenames</option>
                <option value="--no-windows-filenames">No Windows Filenames</option>
              </select>
              <small>Controls how filenames are sanitized. Windows mode uses Windows-compatible characters only.</small>
            </div>
          </div>

          <!-- Additional Arguments -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Additional Arguments
              <span class="help-icon" title="Any extra yt-dlp command-line options">?</span>
              <a href="https://github.com/yt-dlp/yt-dlp#usage-and-options" target="_blank" class="docs-link">üìñ All Options</a>
            </h3>
            <div class="form-group">
              <label for="profile-additional-args">Extra yt-dlp Arguments</label>
              <textarea id="profile-additional-args" rows="3" placeholder="Example: --dateafter 20200101 --geo-bypass"></textarea>
              <small>Advanced yt-dlp options only (space-separated). Examples: --dateafter 20200101, --geo-bypass, --cookies-from-browser chrome</small>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">Create Profile</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Edit Profile Modal -->
  <div id="edit-profile-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Edit yt-dlp Profile</h2>
        <button class="close-btn" onclick="closeEditProfileModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="edit-profile-form" onsubmit="handleEditProfile(event); return false;">
          <input type="hidden" id="edit-profile-id">
          
          <!-- Presets -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>Presets</h3>
            <div class="form-group">
              <label for="edit-preset-select">Select a preset</label>
              <div class="preset-selector">
                <select id="edit-preset-select">
                  <option value="">-- Choose a preset --</option>
                  <option value="plex-youtube">Plex - YouTube-Agent</option>
                </select>
                <button type="button" class="btn btn-secondary" onclick="applyEditPreset()">Apply Preset</button>
              </div>
            </div>
          </div>

          <!-- General Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>General Options</h3>
            <div class="form-group">
              <label for="edit-profile-name">Profile Name</label>
              <input type="text" id="edit-profile-name" placeholder="e.g., Plex 1080p" required>
            </div>
            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem;">
                <div class="toggle-switch">
                  <input type="checkbox" id="edit-profile-verbose">
                  <span class="toggle-slider"></span>
                </div>
                Verbose Mode (-v)
              </label>
              <small>Enable verbose output for debugging</small>
            </div>
          </div>

          <!-- Output Path Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Output Path Options
              <span class="help-icon" title="Define how downloaded files are named and organized">?</span>
              <a href="https://github.com/yt-dlp/yt-dlp#output-template" target="_blank" class="docs-link">üìñ Docs</a>
            </h3>
            <div class="form-group">
              <label for="edit-profile-output-template">Output Template</label>
              <textarea id="edit-profile-output-template" rows="2" placeholder="%(uploader)s [%(channel_id)s]/..." required></textarea>
              <small>Use yt-dlp output template syntax. Available fields: %(uploader)s, %(channel_id)s, %(playlist_title)s, %(playlist_id)s, %(playlist_index)s, %(title)s, %(id)s, %(ext)s</small>
            </div>
          </div>

          <!-- Format Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Format Options
              <span class="help-icon" title="Control video/audio quality and format selection">?</span>
              <a href="https://github.com/yt-dlp/yt-dlp#format-selection" target="_blank" class="docs-link">üìñ Docs</a>
            </h3>
            <div class="form-group">
              <label for="edit-profile-format">Format Selection</label>
              <input type="text" id="edit-profile-format" placeholder='bv*[height=1080]+ba / best'>
              <small>yt-dlp format string. Examples: "bv*[height=1080]+ba" (1080p video + best audio), "bestvideo+bestaudio" (best quality), "worst" (smallest size)</small>
            </div>
            <div class="form-group">
              <label for="edit-profile-merge-format">Merge Output Format</label>
              <input type="text" id="edit-profile-merge-format" placeholder="mp4">
              <small>Container format after merging video+audio (mp4, mkv, webm, etc.)</small>
            </div>
          </div>

          <!-- Filename Options -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Filename Options
              <span class="help-icon" title="Control how filenames are sanitized">?</span>
            </h3>
            <div class="form-group">
              <label for="edit-profile-filename-format">Filename Format</label>
              <select id="edit-profile-filename-format" class="form-select">
                <option value="--no-restrict-filenames">No Restrict Filenames (default)</option>
                <option value="--restrict-filenames">Restrict Filenames</option>
                <option value="--windows-filenames">Windows Filenames</option>
                <option value="--no-windows-filenames">No Windows Filenames</option>
              </select>
              <small>Controls how filenames are sanitized. Windows mode uses Windows-compatible characters only.</small>
            </div>
          </div>

          <!-- Additional Arguments -->
          <div class="content-box" style="margin-bottom: 1rem;">
            <h3>
              Additional Arguments
              <span class="help-icon" title="Any extra yt-dlp command-line options">?</span>
              <a href="https://github.com/yt-dlp/yt-dlp#usage-and-options" target="_blank" class="docs-link">üìñ All Options</a>
            </h3>
            <div class="form-group">
              <label for="edit-profile-additional-args">Extra yt-dlp Arguments</label>
              <textarea id="edit-profile-additional-args" rows="3" placeholder="Example: --dateafter 20200101 --geo-bypass"></textarea>
              <small>Advanced yt-dlp options only (space-separated). Examples: --dateafter 20200101, --geo-bypass, --cookies-from-browser chrome</small>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">Save Changes</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Delete Channel Confirmation Modal -->
  <div id="delete-channel-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <h2>Delete Channel</h2>
        <button class="close-btn" onclick="closeDeleteChannelModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this channel?</p>
        <p style="color: var(--text-muted); margin-top: 0.5rem;">This will remove the channel and all associated playlists from the database.</p>
        
        <div class="form-group" style="margin-top: 1.5rem; padding: 1rem; background: var(--surface-hover); border-radius: 8px;">
          <label>
            <div class="toggle-switch">
              <input type="checkbox" id="delete-files-toggle">
              <span class="toggle-slider"></span>
            </div>
            Also delete downloaded files
          </label>
          <small style="display: block; margin-top: 0.5rem; color: var(--warning);">‚ö†Ô∏è Warning: This will permanently delete all videos, metadata, and thumbnails for this channel from disk. This cannot be undone.</small>
        </div>
        
        <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem;">
          <button class="btn btn-secondary" onclick="closeDeleteChannelModal()">Cancel</button>
          <button class="btn btn-danger" onclick="confirmDeleteChannel()">Delete Channel</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
</body>
</html>
